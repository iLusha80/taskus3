# План переписывания фронтенда на React

## Цель
Переписать существующее веб-приложение, используя React для фронтенда, сохраняя текущую функциональность и взаимодействие с бэкендом.

## 1. Подготовка и инициализация проекта React

*   **1.1. Создание нового React-проекта:**
    *   Использовать `create-react-app` или Vite для быстрой настройки проекта React. Рекомендуется Vite для более быстрой разработки.
    *   Установить необходимые зависимости (React, React DOM).
*   **1.2. Настройка структуры проекта:**
    *   Создать логичную структуру папок для компонентов, хуков, утилит, API-сервисов и страниц.
    *   Пример: `src/components`, `src/pages`, `src/hooks`, `src/services`, `src/utils`.
*   **1.3. Настройка Git:**
    *   Убедиться, что новый React-проект находится под контролем версий Git.
    *   Создать новую ветку для разработки React-версии.

## 2. Миграция API-слоя

*   **2.1. Адаптация `api.js` для React:**
    *   Перенести логику из [`frontend/js/api.js`](frontend/js/api.js) в новый файл, например, `src/services/api.js`.
    *   Убедиться, что функции API возвращают промисы, которые могут быть легко использованы в React-компонентах.
    *   Рассмотреть использование библиотеки для HTTP-запросов, такой как Axios, если это улучшит читаемость и обработку ошибок.
*   **2.2. Обработка ошибок и уведомлений:**
    *   Интегрировать систему уведомлений (`Notification`) в React-контекст (например, с помощью Context API или кастомного хука) для отображения сообщений об успехе/ошибке.

## 3. Реализация маршрутизации React

*   **3.1. Выбор библиотеки маршрутизации:**
    *   Использовать React Router DOM для управления маршрутами.
*   **3.2. Перенос маршрутов:**
    *   Адаптировать маршруты из [`frontend/js/router.js`](frontend/js/router.js) (`/`, `/project/:projectId/board/:boardId`) в React Router.
    *   Настроить компоненты для каждой страницы (например, `HomePage` для `/`, `BoardPage` для `/project/:projectId/board/:boardId`).
*   **3.3. Навигация:**
    *   Заменить прямые вызовы `router.navigate` на `useNavigate` хук из React Router DOM.

## 4. Покомпонентная миграция UI

Это будет самый объемный этап. Каждый существующий компонент из `frontend/js/components/` будет переписан на React.

*   **4.1. Создание базовых компонентов React:**
    *   Начать с простых компонентов, не зависящих от сложной логики (например, `Notification`, `Modal`).
    *   Переписать [`frontend/js/components/Notification.js`](frontend/js/components/Notification.js) и [`frontend/js/components/Modal.js`](frontend/js/components/Modal.js) как React-компоненты.
*   **4.2. Переписывание основных компонентов:**
    *   **`ProjectList`:** Переписать [`frontend/js/components/ProjectList.js`](frontend/js/components/ProjectList.js) как React-компонент.
        *   Использовать `useState` для управления состоянием списка проектов.
        *   Использовать `useEffect` для загрузки проектов при монтировании компонента.
        *   Обработчики событий (`handleAddProject`, `handleProjectActions`) будут перенесены в React-компонент.
        *   Взаимодействие с `Modal` будет осуществляться через пропсы или контекст.
    *   **`BoardNavigation`:** Переписать [`frontend/js/components/BoardNavigation.js`](frontend/js/components/BoardNavigation.js).
        *   Будет отвечать за отображение навигации по проектам и доскам.
        *   Использовать `useParams` из React Router для получения `projectId` и `boardId`.
    *   **`BoardView`:** Переписать [`frontend/js/components/BoardView.js`](frontend/js/components/BoardView.js).
        *   Будет отображать доску с колонками и карточками.
        *   Использовать `useState` для управления состоянием колонок и карточек.
        *   Интегрировать логику Drag and Drop из [`frontend/js/components/DragAndDrop.js`](frontend/js/components/DragAndDrop.js) с использованием библиотек для Drag and Drop в React (например, `react-beautiful-dnd` или `dnd-kit`).
    *   **`Column` и `Card`:** Переписать [`frontend/js/components/Column.js`](frontend/js/components/Column.js) и [`frontend/js/components/Card.js`](frontend/js/components/Card.js) как React-компоненты.
        *   Будут получать данные через пропсы.
        *   Обработчики событий (удаление, редактирование) будут передаваться через пропсы от родительских компонентов.
    *   **`HistoryView`:** Переписать [`frontend/js/components/HistoryView.js`](frontend/js/components/HistoryView.js).
        *   Будет отображать историю изменений карточки.
*   **4.3. Управление состоянием:**
    *   Для глобального состояния (например, данные пользователя, общие настройки) рассмотреть использование React Context API или Redux Toolkit, если приложение станет сложнее. Для текущего приложения, возможно, достаточно будет пропсов и `useState`/`useReducer`.
*   **4.4. Стилизация:**
    *   Перенести стили из [`frontend/style.css`](frontend/style.css) в React-проект.
    *   Рассмотреть использование CSS Modules, Styled Components или Tailwind CSS для более модульной и поддерживаемой стилизации.

## 5. Контейнеризация с Docker

*   **5.1. Обновление `Dockerfile.frontend`:**
    *   Адаптировать существующий [`frontend/Dockerfile.frontend`](frontend/Dockerfile.frontend) для сборки React-приложения.
    *   Использовать многоступенчатую сборку:
        *   Первый этап: сборка React-приложения (например, с помощью `npm run build` или `yarn build`).
        *   Второй этап: использование Nginx для обслуживания статических файлов из собранного React-приложения.
*   **5.2. Обновление `nginx.conf`:**
    *   Убедиться, что [`frontend/nginx.conf`](frontend/nginx.conf) правильно настроен для обслуживания React-приложения (например, для обработки маршрутизации на стороне клиента).
*   **5.3. Обновление `docker-compose.yml`:**
    *   Убедиться, что `docker-compose.yml` правильно настроен для запуска нового React-фронтенда и существующего бэкенда.

## 6. Тестирование

*   **6.1. Юнит-тесты:**
    *   Написать юнит-тесты для React-компонентов и кастомных хуков с использованием Jest и React Testing Library.
*   **6.2. Интеграционные тесты:**
    *   Написать интеграционные тесты для проверки взаимодействия между компонентами и API.

## 7. Система контроля версий (Git)

*   **7.1. Регулярные коммиты:**
    *   Делать частые, осмысленные коммиты.
*   **7.2. Ветвление:**
    *   Использовать отдельные ветки для каждой крупной фичи или миграции компонента.
*   **7.3. Pull Requests/Merge Requests:**
    *   Использовать PR/MR для ревью кода и слияния изменений.

## Диаграмма процесса переписывания

```mermaid
graph TD
    A[Начало: Анализ текущего фронтенда] --> B(Подготовка и инициализация React-проекта)
    B --> C(Миграция API-слоя)
    C --> D(Реализация маршрутизации React)
    D --> E{Покомпонентная миграция UI}
    E --> E1[Переписать ProjectList]
    E --> E2[Переписать BoardNavigation]
    E --> E3[Переписать BoardView]
    E --> E4[Переписать Column и Card]
    E --> E5[Переписать HistoryView]
    E1 & E2 & E3 & E4 & E5 --> F(Контейнеризация с Docker)
    F --> G(Тестирование)
    G --> H[Завершение: React-приложение готово]

    subgraph Git Workflow
        I[Создать новую ветку] --> J[Регулярные коммиты]
        J --> K[Pull Requests/Merge Requests]
        K --> L[Слияние в основную ветку]
    end

    H --> I